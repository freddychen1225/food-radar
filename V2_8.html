<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- ç¶²é æ¨™é¡Œ -->
    <title>ç¾é£Ÿé›·é” V2.8</title>

    <!-- SEO å„ªåŒ–è¨­å®š -->
    <meta name="description" content="ç¾é£Ÿé›·é” (Food Radar) æ˜¯ä¸€æ¬¾å…è²»çš„ Google Maps æ™ºæ…§æœå°‹å·¥å…·ã€‚è§£æ±ºã€Œä»Šå¤©åƒä»€éº¼ã€çš„ç…©æƒ±ï¼Œæä¾›éš¨æ©Ÿç¾é£Ÿæ¨è–¦ã€å¹³åƒ¹æ­£é¤æœå°‹åŠä¸‹åˆèŒ¶é»å¿ƒå»ºè­°ã€‚ä¸ç”¨ä¸‹è¼‰ Appï¼Œæ‰“é–‹ç¶²é å³å¯ä½¿ç”¨ï¼">
    <meta name="keywords" content="ç¾é£Ÿé›·é”, ä»Šå¤©åƒä»€éº¼, é™„è¿‘ç¾é£Ÿ, Google Maps æœå°‹, å¹³åƒ¹ç¾é£Ÿ, ä¸‹åˆèŒ¶æ¨è–¦, éš¨æ©Ÿé¸é¤å»³, è¦ªå­é¤å»³, å¯µç‰©å‹å–„">
    <meta name="author" content="Freddy">

    <!-- Google Search Console é©—è­‰ -->
    <meta name="google-site-verification" content="NQhtyIlgmyy8RmQKDZDP-OYrJlMlkIsO3RromfSEclw" /> 
    
    <!-- === PWA è¨­å®š === -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ç¾é£Ÿé›·é”">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/1046/1046747.png">
    <meta name="theme-color" content="#f7f9fc">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/1046/1046747.png">
    <link rel="manifest" href="manifest.json">

    <!-- å¼•å…¥ä¸è’œå­è¨ˆæ•¸å™¨ -->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <style>
        :root {
            --primary-color: #ff6b6b; --secondary-color: #4ecdc4; --drink-color: #e67e22;
            --special-color: #6c5ce7; --random-color: #9b59b6; --bg-color: #f7f9fc; --text-color: #2d3436;
            --line-color: #06c755; /* LINE å®˜æ–¹ç¶ è‰² */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color); color: var(--text-color);
            margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; box-sizing: border-box; overscroll-behavior-y: none;
        }

        h1 { color: var(--primary-color); font-size: 1.8rem; margin-bottom: 10px; text-align: center; }
        .subtitle { color: #636e72; font-size: 0.9rem; margin-bottom: 20px; text-align: center; }

        .section-title {
            font-size: 1.1rem; font-weight: bold; align-self: flex-start; margin: 20px 0 10px 0;
            padding-left: 5px; border-left: 4px solid var(--primary-color); width: 100%; max-width: 600px;
        }

        .mode-switch {
            display: flex; background: white; border-radius: 15px; padding: 5px;
            width: 100%; max-width: 600px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 10px;
        }

        .mode-btn {
            flex: 1; border: none; background: transparent; padding: 12px 5px; font-size: 1.0rem;
            font-weight: bold; color: #aaa; cursor: pointer; border-radius: 10px; transition: all 0.3s;
            white-space: nowrap; -webkit-tap-highlight-color: transparent;
        }

        .mode-btn.active-meal { background-color: #fff0f0; color: var(--primary-color); box-shadow: 0 2px 5px rgba(255, 107, 107, 0.2); }
        .mode-btn.active-drink { background-color: #fff5e6; color: var(--drink-color); box-shadow: 0 2px 5px rgba(230, 126, 34, 0.2); }
        .mode-btn.active-special { background-color: #f0eeff; color: var(--special-color); box-shadow: 0 2px 5px rgba(108, 92, 231, 0.2); }

        .grid-container {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; max-width: 600px;
        }
        .grid-container.scenarios { grid-template-columns: repeat(2, 1fr); }

        .option-btn {
            background: white; border: 2px solid #e0e0e0; border-radius: 12px; padding: 12px 5px;
            font-size: 0.95rem; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column;
            align-items: center; justify-content: center; min-height: 70px; -webkit-tap-highlight-color: transparent;
        }

        .option-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 10px rgba(0,0,0,0.1); }
        .icon { font-size: 1.5rem; margin-bottom: 5px; }

        .option-btn.selected { border-color: var(--primary-color); background-color: #fff0f0; color: var(--primary-color); font-weight: bold; }
        body.drink-mode .option-btn.selected { border-color: var(--drink-color); background-color: #fff5e6; color: var(--drink-color); }
        body.special-mode .option-btn.selected { border-color: var(--special-color); background-color: #f0eeff; color: var(--special-color); }
        
        #special-notice {
            display: none; text-align: center; font-size: 1.1rem; font-weight: bold;
            color: var(--special-color); margin-top: 25px; margin-bottom: 5px; line-height: 1.6; width: 100%; max-width: 600px;
        }
        body.special-mode #special-notice { display: block; }

        .action-area {
            display: flex; gap: 10px; width: 100%; max-width: 400px; margin-top: 15px;
        }

        .action-btn {
            border: none; border-radius: 50px; padding: 15px 0; font-size: 1.1rem; font-weight: bold;
            color: white; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: all 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 5px; -webkit-tap-highlight-color: transparent;
        }
        .action-btn:active { transform: scale(0.96); }

        #search-btn { flex: 2; background-color: var(--primary-color); box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4); }
        body.drink-mode #search-btn { background-color: var(--drink-color); box-shadow: 0 4px 15px rgba(230, 126, 34, 0.4); }
        body.special-mode #search-btn { background-color: var(--special-color); box-shadow: 0 4px 15px rgba(108, 92, 231, 0.4); }

        #random-btn { flex: 1.2; background-color: var(--random-color); box-shadow: 0 4px 15px rgba(155, 89, 182, 0.4); }
        body.special-mode #random-btn { display: none; }

        .counter-box {
            margin-top: 15px; font-size: 0.9rem; color: #888; text-align: center;
            background-color: rgba(255, 255, 255, 0.6); padding: 5px 15px; border-radius: 20px;
        }

        .footer {
            margin-top: auto; padding-top: 40px; padding-bottom: 20px; font-size: 1.0rem;
            color: #888; font-weight: bold; letter-spacing: 1px; text-align: center;
            display: flex; flex-direction: column; align-items: center; gap: 10px;
        }
        .footer a { color: #888; text-decoration: underline; transition: color 0.2s; }
        .footer a:hover { color: var(--primary-color); }

        /* --- æ¨è–¦æœ‹å‹æŒ‰éˆ• (å¸¸é§åº•éƒ¨) --- */
        .share-btn-footer {
            background-color: var(--line-color); color: white; border: none;
            padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; font-weight: bold;
            cursor: pointer; display: flex; align-items: center; gap: 5px;
            box-shadow: 0 2px 8px rgba(6, 199, 85, 0.3); margin-top: 10px;
        }
        .share-btn-footer:active { transform: scale(0.98); }

        /* --- Android/iOS å¼•å°é®ç½©å…±ç”¨æ¨£å¼ --- */
        .install-guide-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; visibility: hidden; transition: opacity 0.3s;
        }
        .install-guide-overlay.show { opacity: 1; visibility: visible; }
        
        .guide-container {
            background: white; width: 85%; max-width: 350px;
            border-radius: 20px; padding: 25px 20px; text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); position: relative;
        }

        .guide-title { font-size: 1.4rem; font-weight: bold; color: var(--primary-color); margin-bottom: 10px; }
        .guide-subtitle { font-size: 1.0rem; color: #555; margin-bottom: 20px; line-height: 1.5; }
        .guide-gif { width: 100%; border-radius: 10px; border: 2px solid #eee; margin-bottom: 15px; }

        .close-guide-btn {
            background: var(--primary-color); color: white; border: none;
            padding: 10px 30px; border-radius: 50px; font-size: 1rem; font-weight: bold;
            cursor: pointer; width: 100%;
        }

        /* iOS å¼•å°å°ˆç”¨åœ–ç¤º */
        .ios-share-icon { font-size: 1.5rem; vertical-align: middle; margin: 0 5px; color: #007aff; }

    </style>
</head>
<body>

    <h1>ğŸ“ ç¾é£Ÿé›·é” V2.8</h1>
    <div class="subtitle">Google Map æ™ºæ…§å¿«æœ</div>

    <div class="mode-switch">
        <button class="mode-btn active-meal" id="btn-meal" onclick="switchMode('meal')">ğŸ± æ‰¾æ­£é¤</button>
        <button class="mode-btn" id="btn-drink" onclick="switchMode('drink')">ğŸ§‹ ä¸‹åˆèŒ¶</button>
        <button class="mode-btn" id="btn-special" onclick="switchMode('special')">âœ¨ ç‰¹æ®Š</button>
    </div>

    <div class="section-title">1. ç”¨é¤æƒ…å¢ƒ</div>
    <div class="grid-container scenarios" id="scenario-container">
        <button class="option-btn selected" data-keyword="" onclick="selectScenario(this)"><span class="icon">ğŸ´</span>éš¨ä¾¿åƒåƒ</button>
        <button class="option-btn" data-keyword="é©åˆå–®äºº" onclick="selectScenario(this)"><span class="icon">ğŸ‘¤</span>1äººç¨äº«</button>
        <button class="option-btn" data-keyword="æ°£æ°›" onclick="selectScenario(this)"><span class="icon">ğŸ‘¥</span>2äººç´„æœƒ</button>
        <button class="option-btn" data-keyword="èšé¤" onclick="selectScenario(this)"><span class="icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span>å¤šäººèšé¤</button>
    </div>

    <div class="section-title" id="type-title">2. æƒ³åƒä»€éº¼ï¼Ÿ</div>
    <div class="grid-container" id="cuisine-container"></div>

    <div id="special-notice">
        æœ¬å€â€œç‰¹æ®Šâ€é¡åˆ¥æœå°‹å¾Œ<br>
        è‡ªè¡Œç¢ºèªç¬¦åˆéœ€æ±‚å†å‰å¾€æ¶ˆè²»å–”
    </div>

    <div class="action-area">
        <button id="search-btn" class="action-btn" onclick="goSearch()">
            ğŸ” æœå°‹
        </button>
        <button id="random-btn" class="action-btn" onclick="goRandom()">
            ğŸ² å¹«æˆ‘é¸
        </button>
    </div>

    <div class="counter-box">
        å·²æœ‰ <span id="busuanzi_value_site_pv">...</span> äººäº«ç”¨ç¾é£Ÿäº†
    </div>

    <div class="footer">
        <!-- æ–°å¢ï¼šæ¨è–¦æœ‹å‹æŒ‰éˆ• -->
        <button class="share-btn-footer" onclick="shareToFriend('general')">
            ğŸ’¬ æ¨è–¦æœ‹å‹
        </button>
        <div>
            <a href="https://www.threads.net/@freddychen1225" target="_blank">Freddy</a> & Gemini 3 Pro è¨­è¨ˆå”ä½œ
        </div>
    </div>

    <!-- Android å®‰è£æ•™å­¸é®ç½© -->
    <div id="android-guide" class="install-guide-overlay" onclick="this.classList.remove('show')">
        <div class="guide-container">
            <div class="guide-title">ğŸ‰ å®‰è£æˆåŠŸï¼</div>
            <div class="guide-subtitle">è«‹ä¾ç…§ä¸‹æ–¹å‹•ç•«ï¼Œå°‡åœ–ç¤ºåŠ åˆ°æ¡Œé¢</div>
            <img src="install-guide.gif" alt="å®‰è£æ•™å­¸" class="guide-gif">
            <button class="close-guide-btn" onclick="document.getElementById('android-guide').classList.remove('show')">æˆ‘çŸ¥é“äº†</button>
        </div>
    </div>

    <!-- iOS å®‰è£æ•™å­¸é®ç½© (æ–°å¢) -->
    <div id="ios-guide" class="install-guide-overlay">
        <div class="guide-container">
            <div class="guide-title">ğŸ˜‹ é¤“è‚šå­ä¸èƒ½ç­‰ï¼</div>
            <div class="guide-subtitle" style="text-align: left;">
                ç™¼ç¾æ‚¨è »å¸¸ä¾†æ‰¾ç¾é£Ÿçš„ï¼æŠŠé›·é”åŠ åˆ°æ¡Œé¢ï¼Œä¸‹æ¬¡è‚šå­é¤“æ™‚ï¼Œæ¯”åˆ¥äºº<b>å¿« 10 ç§’</b>æ‰¾åˆ°åƒçš„ï¼<br><br>
                1. é»æ“Šç€è¦½å™¨ä¸‹æ–¹çš„ <span class="ios-share-icon">ğŸ“¤</span> åˆ†äº«æŒ‰éˆ•<br>
                2. å¾€ä¸‹æ»‘æ‰¾åˆ°ã€ŒåŠ å…¥ä¸»ç•«é¢ã€<span class="ios-share-icon">â•</span><br>
                3. é»æ“Šå³ä¸Šè§’ã€ŒåŠ å…¥ã€
            </div>
            <button class="close-guide-btn" onclick="closeIOSGuide()">æˆ‘çŸ¥é“äº†</button>
        </div>
    </div>

    <script>
        // --- è³‡æ–™åº« ---
        const mealCategories = [
            { name: "ç‰›è‚‰éºµ", icon: "ğŸœ" }, { name: "ä¾¿ç•¶ç°¡é¤", icon: "ğŸ±" }, { name: "å°åƒ/éºµåº—", icon: "ğŸ¢" },
            { name: "æ»·å‘³", icon: "ğŸ¥˜" }, { name: "æ°´é¤ƒ/é‹è²¼", icon: "ğŸ¥Ÿ" }, { name: "ç«é‹", icon: "ğŸ²" },
            { name: "éµæ¿ç‡’", icon: "ğŸ‘¨â€ğŸ³" }, { name: "ç‰›æ’", icon: "ğŸ¥©" }, { name: "ç¾©å¤§åˆ©éºµ", icon: "ğŸ" },
            { name: "æ¼¢å ¡/é€Ÿé£Ÿ", icon: "ğŸ”" }, { name: "æ—¥å¼æ–™ç†", icon: "ğŸ£" }, { name: "éŸ“å¼æ–™ç†", icon: "ğŸ¥˜" },
            { name: "æ³°å¼æ–™ç†", icon: "ğŸŒ¶ï¸" }, { name: "å’–å“©", icon: "ğŸ›" }, { name: "æ—©åˆé¤", icon: "ğŸ¥ª" }
        ];
        const drinkCategories = [
            { name: "æ‰‹æ–é£²", icon: "ğŸ§‹" }, { name: "å’–å•¡å»³", icon: "â˜•" }, { name: "ç‚¸é›/é¹½é…¥é›", icon: "ğŸ—" },
            { name: "è‡­è±†è…", icon: "ğŸ‘ƒ" }, { name: "éºµç·š", icon: "ğŸœ" }, { name: "è»Šè¼ªé¤…", icon: "ğŸ¥" },
            { name: "é›è›‹ç³•", icon: "ğŸ¥š" }, { name: "è”¥æ²¹é¤…/æŠ“é¤…", icon: "ğŸŒ¯" }, { name: "ç”œé»", icon: "ğŸ°" },
            { name: "å†°å“", icon: "ğŸ§" }, { name: "éºµåŒ…", icon: "ğŸ" }, { name: "ç”œç”œåœˆ", icon: "ğŸ©" }, { name: "ç« é­šç‡’", icon: "ğŸ™" }
        ];
        const specialCategories = [
            { name: "ç´ é£Ÿ", icon: "ğŸ¥¬" }, { name: "è¦ªå­é¤å»³", icon: "ğŸ‘¶" }, { name: "å¯µç‰©å‹å–„é¤å»³", icon: "ğŸ¶" }
        ];

        let currentMode = 'meal'; 
        let selectedScenarioKeyword = "";
        let selectedCuisineKeyword = "";

        // æª¢æŸ¥ç’°å¢ƒ
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        const isPWA = window.matchMedia('(display-mode: standalone)').matches || (window.navigator.standalone === true);

        // åˆ†äº«é€£çµ (å¼·åˆ¶ç”¨å¤–éƒ¨ç€è¦½å™¨é–‹å•Ÿ)
        const SHARE_URL = "https://freddychen1225.github.io/food-radar/?openExternalBrowser=1";

        document.addEventListener('DOMContentLoaded', function() {
            renderCuisines(mealCategories);
            
            // --- Android å®‰è£å¾ŒæŒ‡å¼• ---
            window.addEventListener('appinstalled', (evt) => {
                if (/Android/i.test(navigator.userAgent)) {
                    document.getElementById('android-guide').classList.add('show');
                }
            });

            // --- iOS å®‰è£å¼•å°æª¢æŸ¥ (ç¬¬3æ¬¡æœå°‹å›ä¾†) ---
            checkIOSGuide();
        });

        // æª¢æŸ¥æ˜¯å¦éœ€è¦é¡¯ç¤º iOS å¼•å°
        function checkIOSGuide() {
            // æ¢ä»¶ï¼šæ˜¯ iOSã€ä¸æ˜¯ PWAã€é‚„æ²’çœ‹éå¼•å°
            if (isIOS && !isPWA && !localStorage.getItem('iosGuideShown')) {
                // å–å¾—æœå°‹æ¬¡æ•¸
                let count = parseInt(localStorage.getItem('searchCount') || '0');
                if (count >= 3) {
                    // å»¶é² 1 ç§’é¡¯ç¤ºï¼Œé¿å…å¤ªçªå…€
                    setTimeout(() => {
                        document.getElementById('ios-guide').classList.add('show');
                    }, 1000);
                }
            }
        }

        // é—œé–‰ iOS å¼•å°ä¸¦è¨˜éŒ„
        function closeIOSGuide() {
            document.getElementById('ios-guide').classList.remove('show');
            localStorage.setItem('iosGuideShown', 'true');
        }

        // åˆ†äº«åŠŸèƒ½ (é›™è»Œåˆ¶)
        function shareToFriend(type, foodName = "") {
            let text = "";
            if (type === 'general') {
                // æ–¹æ¡ˆ C: æ¨è–¦å¥½ç‰©
                text = `ç™¼ç¾ä¸€å€‹è¶…å¥½ç”¨çš„æ‰¾ç¾é£Ÿå·¥å…·ï¼ä¸ç”¨ä¸‹è¼‰ Appï¼Œæ‰“é–‹å°±èƒ½ç”¨ï¼Œå°ˆæ²»é¸æ“‡å›°é›£ç—‡ï¼ğŸ’ŠğŸ” ${SHARE_URL}`;
            } else if (type === 'random') {
                // æ–¹æ¡ˆ A: è§£æ•‘é¸æ“‡å›°é›£
                text = `æ•‘æ˜Ÿä¾†äº†ï¼ä»¥å¾Œåƒé£¯ä¸ç”¨å†å•ã€åƒä»€éº¼ã€äº†ï¼Œç›´æ¥ç”¨é€™å€‹ç¥å™¨è½‰ä¸€ä¸‹ï¼ğŸ±âœ¨ ${SHARE_URL}`;
            }

            // å–šèµ· LINE
            const lineUrl = `https://line.me/R/msg/text/?${encodeURIComponent(text)}`;
            window.location.href = lineUrl;
        }

        function switchMode(mode) {
            currentMode = mode;
            const btnMeal = document.getElementById('btn-meal');
            const btnDrink = document.getElementById('btn-drink');
            const btnSpecial = document.getElementById('btn-special');
            const body = document.body;

            btnMeal.className = 'mode-btn'; btnDrink.className = 'mode-btn'; btnSpecial.className = 'mode-btn';
            body.classList.remove('drink-mode', 'special-mode');

            if (mode === 'meal') {
                btnMeal.className = 'mode-btn active-meal'; renderCuisines(mealCategories);
            } else if (mode === 'drink') {
                btnDrink.className = 'mode-btn active-drink'; body.classList.add('drink-mode'); renderCuisines(drinkCategories);
            } else if (mode === 'special') {
                btnSpecial.className = 'mode-btn active-special'; body.classList.add('special-mode'); renderCuisines(specialCategories);
            }
            selectedCuisineKeyword = "";
        }

        function renderCuisines(list) {
            const container = document.getElementById('cuisine-container');
            container.innerHTML = ""; 

            list.forEach(item => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `<span class="icon">${item.icon}</span>${item.name}`;
                btn.dataset.name = item.name; 
                
                btn.addEventListener('click', function() {
                    const allBtns = container.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedCuisineKeyword = item.name;
                });
                container.appendChild(btn);
            });
        }

        function selectScenario(btn) {
            const container = document.getElementById('scenario-container');
            const allBtns = container.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedScenarioKeyword = btn.getAttribute('data-keyword');
        }

        function goSearch() {
            if (!selectedCuisineKeyword) {
                let typeName = "æ­£é¤";
                if(currentMode === 'drink') typeName = "é»å¿ƒ";
                if(currentMode === 'special') typeName = "ç‰¹æ®Šéœ€æ±‚";
                const randomHint = currentMode === 'special' ? "" : "ï¼Œæˆ–æŒ‰ã€ŒğŸ² å¹«æˆ‘é¸ã€";
                alert(`è«‹å…ˆé¸æ“‡${typeName}é¡å‹${randomHint}ï¼`);
                return;
            }
            performSearch(selectedCuisineKeyword);
        }

        function goRandom() {
            if(currentMode === 'special') return;
            const container = document.getElementById('cuisine-container');
            const options = container.querySelectorAll('.option-btn');
            const randomIndex = Math.floor(Math.random() * options.length);
            const selectedBtn = options[randomIndex];
            const keyword = selectedBtn.dataset.name;

            const allBtns = container.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.classList.remove('selected'));
            selectedBtn.classList.add('selected');
            selectedCuisineKeyword = keyword;

            // ç¨å¾®å»¶é²è®“ä½¿ç”¨è€…çœ‹åˆ°é¸ä¸­æ•ˆæœ
            setTimeout(() => {
                // è‡ªè¨‚ç¢ºèªè¦–çª— (ç‚ºäº†åŠ å…¥åˆ†äº«æŒ‰éˆ•)
                // é€™è£¡ä½¿ç”¨ç°¡å–®çš„ confirm åšä¸åˆ°é›™æŒ‰éˆ•ï¼Œæ‰€ä»¥æˆ‘å€‘ç”¨ä¸€å€‹ trickï¼š
                // å¦‚æœæ˜¯å‘½é‹é¸çš„ï¼Œæˆ‘å€‘é‚„æ˜¯å…ˆç”¨ confirm è®“ä»–æ±ºå®šè¦ä¸è¦å‡ºç™¼
                // ä½†åœ¨å¯¦éš›ç”¢å“ä¸­ï¼Œé€™ä¸€æ­¥æœ€å¥½æ”¹æˆè‡ªè¨‚ Modalï¼Œé€™é‚Šå…ˆç¶­æŒç°¡å–®é‚è¼¯ï¼Œ
                // è‹¥è¦åˆ†äº«ï¼Œè«‹ä½¿ç”¨åº•éƒ¨çš„æ¨è–¦æœ‹å‹ï¼Œæˆ–è€…æˆ‘å€‘å¯ä»¥åœ¨ confirm å¾Œå¤šè·³ä¸€å€‹æç¤ºï¼Ÿ
                // ä¿®æ­£ç­–ç•¥ï¼šå› ç‚º confirm åªæœ‰ç¢ºå®š/å–æ¶ˆï¼Œç„¡æ³•åŠ åˆ†äº«æŒ‰éˆ•ã€‚
                // ç‚ºäº†ä¸è®“ç¨‹å¼ç¢¼è®Šå¾—å¤ªè¤‡é›œï¼ˆæ‰‹åˆ» Modalï¼‰ï¼Œæˆ‘å€‘å…ˆç¶­æŒåº•éƒ¨æŒ‰éˆ•ã€‚
                // å¦‚æœæ‚¨å¸Œæœ›éš¨æ©Ÿçµæœä¹Ÿæœ‰åˆ†äº«æŒ‰éˆ•ï¼Œå»ºè­°ä¹‹å¾Œå¯ä»¥è€ƒæ…®æŠŠ alert/confirm æ›æˆ SweetAlert ç­‰å¥—ä»¶ã€‚
                // *æœ¬æ¬¡æ›´æ–°å…ˆåœ¨åº•éƒ¨åŠ å…¥å¸¸é§åˆ†äº«æŒ‰éˆ•*
                
                if(confirm(`å‘½é‹æ±ºå®šåƒï¼š${keyword}ï¼\nè¦ç¾åœ¨å‡ºç™¼å—ï¼Ÿ`)) {
                    performSearch(keyword);
                }
            }, 100);
        }

        function performSearch(keyword) {
            // è¨˜éŒ„æœå°‹æ¬¡æ•¸ (ç‚ºäº† iOS å¼•å°)
            let count = parseInt(localStorage.getItem('searchCount') || '0');
            localStorage.setItem('searchCount', count + 1);

            let query = keyword;
            if (selectedScenarioKeyword) { query += " " + selectedScenarioKeyword; }
            const mapUrl = `https://www.google.com/maps/search/${encodeURIComponent(query)}`;
            
            // iOS PWA å¼·åˆ¶è·³è½‰
            if (isIOS && isPWA) {
                window.location.href = mapUrl;
            } else {
                window.open(mapUrl, '_blank');
            }
        }
    </script>
</body>
</html>
